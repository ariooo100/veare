{"version":3,"sources":["page-sections.js","responsiveImage.js"],"names":["makeTemplate","strings","html","length","template","document","createElement","innerHTML","_templateObject","PageSectionContainer","_CustomElement2","_classCallCheck","this","_this","_possibleConstructorReturn","__proto__","Object","getPrototypeOf","call","shadowRoot","attachShadow","mode","ShadyCSS","prepareTemplate","styleElement","appendChild","importNode","content","_inherits","_createClass","key","value","fn","element","window","addEventListener","clearTimeout","setTimeout","setActiveState","_inView","_setActive","Array","prototype","slice","querySelectorAll","map","item","index","array","parent","_setUnactive","hasAttribute","setAttribute","dispatchEvent","CustomEvent","detail","wasActivated","getAttribute","removeAttribute","get","getBoundingClientRect","bottom","top","innerHeight","_CustomElement","template$1","PageSection","_CustomElement3","_this2","minVisible","Math","min","parseFloat","requiredVisiblePx","height","visibleHeight","max","customElements","define","ready","readyState","ResponsiveImage","_src","_placeholder","_active","undefined","_img","_aspectRatio","_observer","_threshold","attrName","oldVal","newVal","_setAspectRatio","_loadPlaceholder","_createObserver","querySelector","_destroyObserver","IntersectionObserver","changes","forEach","change","isIntersecting","target","threshold","observe","unobserve","style","paddingBottom","set","src","_loadImage","placeholder","active","toString","toFixed","isNaN","aspectRatio","ratios","split","ratio","parseInt"],"mappings":"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","file":"webcomponents.js","sourcesContent":["(function () {\n'use strict';\n\nconst makeTemplate = function (strings) {\n    let html = strings[strings.length - 1];\n    let template = document.createElement('template');\n    template.innerHTML = html;\n    return template;\n};\n\nlet template = makeTemplate `<style>\n    :host{\n        display: inline-block;\n        flex: 0 1 auto;\n        box-sizing: border-box;\n        width: 100%;\n        height: auto;\n        min-height: 100vh;\n        align-self: center;\n    }\n  </style>\n  <slot></slot>\n`;\nclass PageSectionContainer extends HTMLElement {\n    constructor() {\n        super();\n        let shadowRoot = this.attachShadow({ mode: 'open' });\n        if (typeof ShadyCSS !== 'undefined') {\n            ShadyCSS.prepareTemplate(template, 'page-section-container');\n            ShadyCSS.styleElement(this);\n        }\n        shadowRoot.appendChild(document.importNode(template.content, true));\n    }\n    connectedCallback() {\n        let element = this;\n        var fn;\n        window.addEventListener('scroll', function () {\n            clearTimeout(fn);\n            fn = setTimeout(function () {\n                element.setActiveState();\n            }, 10);\n        });\n        setTimeout(function () {\n            element.setActiveState();\n        }, 1);\n    }\n    get _inView() {\n        return this.getBoundingClientRect().bottom > 0 && this.getBoundingClientRect().top < window.innerHeight;\n    }\n    setActiveState() {\n        if (this._inView) {\n            this._setActive();\n            Array.prototype.slice.call(this.querySelectorAll('page-section')).map(function (item, index, array) {\n                item.parent = item;\n                item.setActiveState();\n            });\n        }\n        else {\n            this._setUnactive();\n        }\n    }\n    _setActive() {\n        if (this.hasAttribute('active'))\n            return;\n        this.setAttribute('active', '');\n        this.dispatchEvent(new CustomEvent('activated', { 'detail': {\n                'wasActivated': this.getAttribute('wasActivated') !== null\n            } }));\n    }\n    _setUnactive() {\n        if (this.hasAttribute('active') && !this.hasAttribute('wasActivated')) {\n            this.setAttribute('wasActivated', '');\n        }\n        this.removeAttribute('active');\n        this.dispatchEvent(new CustomEvent('deactivated'));\n    }\n}\n\nlet template$1 = makeTemplate `<style>\n    :host{\n        display: inline-block;\n        flex: 0 1 auto;\n        box-sizing: border-box;\n        width: 100%;\n        height: auto;\n        min-height: 100vh;\n        align-self: center;\n    }\n  </style>\n  <slot></slot>\n`;\nclass PageSection extends HTMLElement {\n    constructor() {\n        super();\n        let shadowRoot = this.attachShadow({ mode: 'open' });\n        if (typeof ShadyCSS !== 'undefined') {\n            ShadyCSS.prepareTemplate(template$1, 'page-section');\n            ShadyCSS.styleElement(this);\n        }\n        shadowRoot.appendChild(document.importNode(template$1.content, true));\n    }\n    get _inView() {\n        var minVisible = Math.min(1, (parseFloat(this.getAttribute('requiredVisible')) || parseFloat(this.parent.getAttribute('requiredVisible')) || 0.6));\n        var requiredVisiblePx = minVisible * Math.min(this.getBoundingClientRect().height, window.innerHeight);\n        var visibleHeight = this.getBoundingClientRect().height;\n        visibleHeight += Math.min(0, this.getBoundingClientRect().top);\n        visibleHeight -= Math.max(0, (this.getBoundingClientRect().bottom - window.innerHeight));\n        return visibleHeight >= requiredVisiblePx;\n    }\n    setActiveState() {\n        if (this._inView) {\n            this._setActive();\n        }\n        else {\n            this._setUnactive();\n        }\n    }\n    _setActive() {\n        if (this.hasAttribute('active'))\n            return;\n        this.setAttribute('active', '');\n        this.dispatchEvent(new CustomEvent('activated', { 'detail': {\n                'wasActivated': this.getAttribute('wasActivated') !== null\n            } }));\n    }\n    _setUnactive() {\n        if (this.hasAttribute('active') && !this.hasAttribute('wasActivated')) {\n            this.setAttribute('wasActivated', '');\n        }\n        this.removeAttribute('active');\n        this.dispatchEvent(new CustomEvent('deactivated'));\n    }\n}\n\nwindow.customElements.define('page-sections', PageSectionContainer);\nwindow.customElements.define('page-section', PageSection);\n\n}());\n//# sourceMappingURL=page-sections.js.map\n","(function () {\n'use strict';\n\nconst makeTemplate = function (strings) {\n    let html = strings[strings.length - 1];\n    let template = document.createElement('template');\n    template.innerHTML = html;\n    return template;\n};\n//# sourceMappingURL=makeTemplate.js.map\n\nvar ready = function (fn) {\n    if (document.readyState !== 'loading') {\n        fn();\n    }\n    else {\n        document.addEventListener('DOMContentLoaded', fn);\n    }\n};\n\n\n//# sourceMappingURL=ready.js.map\n\nlet template = makeTemplate `<style>\n    :host{\n      display: block;\n    }\n    img{\n      width: 100%;\n      height: auto;\n      vertical-align: top;\n    }\n    figure{\n      margin: 0;\n      display: block;\n      position: relative;\n      overflow: hidden;\n    }\n    :host([ratio]) figure{\n      height: 0;\n      width: 100%;\n    }\n  </style>\n  <figure>\n    <img src=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" alt=\"\" />\n  </figure>`;\nclass ResponsiveImage extends HTMLElement {\n    constructor() {\n        super();\n        this._src = null;\n        this._placeholder = null;\n        this._active = undefined;\n        this._img = null;\n        this._aspectRatio = null;\n        this._observer = null;\n        this._threshold = 0.5;\n        let shadowRoot = this.attachShadow({ mode: 'open' });\n        if (typeof ShadyCSS !== 'undefined') {\n            ShadyCSS.prepareTemplate(template, 'responsive-image');\n            ShadyCSS.styleElement(this);\n        }\n        shadowRoot.appendChild(document.importNode(template.content, true));\n    }\n    static get observedAttributes() {\n        return ['src', 'placeholder', 'active', 'threshold', 'ratio'];\n    }\n    attributeChangedCallback(attrName, oldVal, newVal) {\n        this[attrName] = newVal;\n    }\n    connectedCallback() {\n        this._setAspectRatio();\n        this._loadPlaceholder();\n        this._createObserver();\n    }\n    _loadImage() {\n        if (this._src === null || this._active !== 'true')\n            return;\n        let _img = document.createElement('img');\n        _img.addEventListener('load', () => {\n            this._img = this.shadowRoot.querySelector('img');\n            this._img.setAttribute('src', this._src);\n        });\n        ready(() => {\n            _img.setAttribute('src', this._src);\n            this._destroyObserver();\n        });\n    }\n    _loadPlaceholder() {\n        if (this._placeholder === null)\n            return;\n        this.shadowRoot.querySelector('img').setAttribute('src', this._placeholder);\n    }\n    _createObserver() {\n        if (this._active !== undefined)\n            return;\n        this._observer = new IntersectionObserver((changes) => {\n            changes.forEach((change) => {\n                if (change.isIntersecting) {\n                    change.target.setAttribute('active', 'true');\n                }\n            });\n        }, {\n            threshold: this.threshold\n        });\n        this._observer.observe(this);\n    }\n    _destroyObserver() {\n        if (this._observer === null)\n            return;\n        this._observer.unobserve(this);\n    }\n    _setAspectRatio() {\n        if (this._aspectRatio) {\n            this.shadowRoot.querySelector('figure').style.paddingBottom = this._aspectRatio + '%';\n        }\n    }\n    set src(src) {\n        if (this._src === src)\n            return;\n        this._src = src;\n        if (document.readyState !== 'loading') {\n            this._loadImage();\n        }\n    }\n    get src() {\n        return this._src;\n    }\n    set placeholder(placeholder) {\n        if (this._placeholder === placeholder)\n            return;\n        this._placeholder = placeholder;\n    }\n    get placeholder() {\n        return this._placeholder;\n    }\n    set active(active) {\n        active = (active === 'true' || active === true).toString();\n        if (this._active === active)\n            return;\n        this._active = active;\n        this.setAttribute('active', this._active);\n        this._loadImage();\n    }\n    get active() {\n        return this._active;\n    }\n    set threshold(threshold) {\n        threshold = parseFloat(parseFloat(threshold + '').toFixed(2));\n        if (isNaN(threshold) || threshold > 1 || threshold < 0)\n            threshold = 1;\n        if (this._threshold === threshold)\n            return;\n        this._threshold = threshold;\n    }\n    get threshold() {\n        return this._threshold;\n    }\n    set ratio(aspectRatio) {\n        if (this._aspectRatio === aspectRatio)\n            return;\n        let ratios = aspectRatio.split(':');\n        let ratio = null;\n        if (ratios.length > 1) {\n            ratio = 100 * (parseInt(ratios[1]) / parseInt(ratios[0]));\n        }\n        else {\n            ratio = parseInt(ratios[0]);\n        }\n        if (!isNaN(ratio)) {\n            this._aspectRatio = ratio;\n            this._setAspectRatio();\n        }\n    }\n    get ratio() {\n        return this._aspectRatio;\n    }\n}\nwindow.customElements.define('responsive-image', ResponsiveImage);\n\n}());\n//# sourceMappingURL=responsiveImage.js.map\n"]}